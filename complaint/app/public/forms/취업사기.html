<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>취업사기</title>
  <link rel="stylesheet" href="/forms/basic_info_style.css" type = "text/css">
</head>

<script language='javascript'>

  var is_submit = true;
  var _NEXT_FOCUS = ""; // 커서가 갈 곳..

  function check_form(){

      f = document.form;

     if(is_submit == true){
        return true;
     }else{
        f[_NEXT_FOCUS].focus();
        is_submit = true;
        return false;
    }
  }

  function next_input(next_focus){
    if(event.keyCode == 13){
         is_submit = false;
        _NEXT_FOCUS = next_focus;
     }
  }

</script>

<body>

  <h1>PAILAB AI 고소장 생성 서비스</h1>

  <form action="/loading"
      method="post"
      name="취업사기"
      >

    <fieldset style = "width:10">
        <legend>피해 일시 및 장소</legend>
  
          피해 일시: <input type="datetime-local" id="피해 일시" name="피해 일시" onKeyDown="next_input('피해 장소');" required> </br></br>  

          피해 장소: <input type="text" id="피해 장소" name="피해 장소" onKeyDown="next_input('피고소인이 취업시켜주겠다고 한 회사명');" required> </br>
  
      </fieldset> </br>


    <fieldset style = "width:10">
      <legend>취업사기 고소내용 입력</legend>

        피고소인이 취업시켜주겠다고 한 회사명: <input type="text" id="피고소인이 취업시켜주겠다고 한 회사명" name="피고소인이 취업시켜주겠다고 한 회사명" onKeyDown="next_input('피고소인과 해당 회사와의 관계');" required> </br></br>

        피고소인과 해당 회사와의 관계: <input type="text" id="피고소인과 해당 회사와의 관계" name="피고소인과 해당 회사와의 관계" onKeyDown="next_input('취업에 관한 이야기를 나누게 된 경위');" required> </br></br>
        
        취업에 관한 이야기를 나누게 된 경위: <input type="text" id="취업에 관한 이야기를 나누게 된 경위" name="취업에 관한 이야기를 나누게 된 경위" onKeyDown="next_input('피의자의 기망행위(피의자에게 속게 된 결정적인 이유 및 근거)');" required> </br></br>

      <label for="myTextarea">피의자의 기망행위(피의자에게 속게 된 결정적인 이유 및 근거): </label> </br>
      <textarea id="피의자의 기망행위(피의자에게 속게 된 결정적인 이유 및 근거)" name="피의자의 기망행위(피의자에게 속게 된 결정적인 이유 및 근거)" rows="2" cols="200"></textarea> </br>

        피해 금액 또는 재산상 이익: <input type="text" id="피해 금액 또는 재산상 이익" name="피해 금액 또는 재산상 이익" onKeyDown="next_input('피해 금액의 변제 여부(금액)');" required> </br></br>

        피해 금액의 변제 여부(금액): <input type="text" id="피해 금액의 변제 여부(금액)" name="피해 금액의 변제 여부(금액)" onKeyDown="next_input('동일 건 고소 및 취소 사실 여부');" required> </br>
    </fieldset> </br>

    
    <fieldset style = "width:10">
        <legend>추가 정보 입력</legend>
  
          동일 건 고소 및 취소 사실 여부: <select id="option" name="동일 건 고소 및 취소 사실 여부" onKeyDown="next_input('관련 형사사건 수사 유무');" required></br></br>
            <option value="" disabled selected hidden>선택</option>
            <option value="있음">있음</option>
            <option value="없음">없음</option>
          </select></br></br>

          관련 형사사건 수사 유무: <select id="option" name="관련 형사사건 수사 유무" onKeyDown="next_input('피고소인과 합의 여부');" required></br></br>
            <option value="" disabled selected hidden>선택</option>
            <option value="있음">있음</option>
            <option value="없음">없음</option>
          </select></br></br>
  
          피고소인과 합의 여부: <select id="option" name="피고소인과 합의 여부" onKeyDown="next_input('피고소인 처벌 의사');" required> </br></br>
            <option value="" disabled selected hidden>선택</option>
            <option value="합의하였음">합의하였음</option>
            <option value="합의하지 않음">합의하지 않음</option>
          </select></br></br>
          
          피고소인 처벌 의사: <select id="option" name="피고소인 처벌 의사" onKeyDown="next_input('고소 내용을 증명할 수 있는 증거');" required> </br></br>
            <option value="" disabled selected hidden>선택</option>
            <option value="처벌 원함">처벌 원함</option>
            <option value="처벌 원하지 않음">처벌 원하지 않음</option>
          </select></br></br>

          <label for="myTextarea">고소 내용을 증명할 수 있는 증거: </label> </br>
          <textarea id="고소 내용을 증명할 수 있는 증거" name="고소 내용을 증명할 수 있는 증거" rows="2" cols="200"></textarea> </br></br>
  
          <label for="myTextarea">기타 수사에 필요한 사항: </label> </br>
          <textarea id="기타 수사에 필요한 사항" name="기타 수사에 필요한 사항" rows="2" cols="200"></textarea> </br></br>

          제출 경찰서: 
          <select id="제출 경찰서" name="제출 경찰서" required>
            <option value="" disabled selected hidden>선택</option>
          </select> </br></br>

          고소 일자: <input type="date" max = "9999-12-31" id="고소일자" name="고소일자" required> </br></br>

          
  

    </fieldset> </br>
    
    <p>제출 버튼을 누르면 AI가 고소장을 만들고 처리하는데 시간이 소요되오니 잠시만 기다려주시기 바랍니다.</p>

    <input type='submit' value='제출하기' onClick='return check_form();'>
  </form>

</body>
<script>
  const FORM_KEY = "취업사기";

  // 모든 input / textarea / select 저장
  function saveForm() {
    const data = {};
    document.querySelectorAll("input, textarea, select").forEach(el => {
      if (el.name) {
        data[el.name] = el.value;
      }
    });
    localStorage.setItem(FORM_KEY, JSON.stringify(data));
  }

  // 저장된 데이터 복원
  function loadForm() {
    const saved = localStorage.getItem(FORM_KEY);
    if (!saved) return;

    const data = JSON.parse(saved);
    document.querySelectorAll("input, textarea, select").forEach(el => {
      if (el.name && data[el.name] !== undefined) {
        el.value = data[el.name];
      }
    });
  }

  // 제출 성공 시 임시저장 삭제
  function clearFormStorage() {
    localStorage.removeItem(FORM_KEY);
  }

  // 이벤트 연결
  window.addEventListener("load", loadForm);
  document.addEventListener("input", saveForm);

  fetch("https://complaint-api.knpu.re.kr/api/police/stations")
    .then(response => {
      if (!response.ok) {
        throw new Error("경찰서 목록 요청 실패");
      }
      return response.json();
    })
    .then(data => {
      const select = document.getElementById("제출 경찰서");

      data.forEach(item => {
        const option = document.createElement("option");

        option.value = item.name;
        option.textContent = item.name;

        select.appendChild(option);
      });
    })
    .catch(error => {
      console.error(error);
      alert("경찰서 목록을 불러오지 못했습니다.");
    });
</script>
</html> 