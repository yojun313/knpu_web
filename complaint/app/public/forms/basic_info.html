<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <script src="https://t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PAILAB AI 고소장 생성 서비스</title>
  <link rel="stylesheet" href="/forms/basic_info_style.css" type = "text/css">
</head>

<script language='javascript'>

  var is_submit = true;
  var _NEXT_FOCUS = ""; // 커서가 갈 곳..

  function check_form(){

      f = document.form;

     if(is_submit == true){
        return true;
     }else{
        f[_NEXT_FOCUS].focus();
        is_submit = true;
        return false;
    }
  }

  function next_input(next_focus){
    if(event.keyCode == 13){
         is_submit = false;
        _NEXT_FOCUS = next_focus;
     }
  }

</script>

<body>
  <datalist id="email-domain-list"></datalist>
  <h1>PAILAB AI 고소장 생성 서비스</h1> 

  <form action = "/submit" accept-charset = "utf-8" name = "sue_info" method = "post">

    <div class="container">

      <div class="addinfo_container">
        <fieldset>
          <legend>고소 죄명</legend>
  
          고소 죄명: <select id="option" name="고소 죄명" required></br></br>
            <option value="" disabled selected hidden>선택</option>
            <option value="계약금사기">계약금사기</option>
            <option value="보험사기">보험사기</option>
            <option value="분양사기">분양사기</option>
            <option value="소송사기">소송사기</option>
            <option value="아이템사기">아이템사기</option>
            <option value="인터넷물품사기">인터넷물품사기</option>
            <option value="차용사기">차용사기</option>
            <option value="취업사기">취업사기</option>
            <option value="기타사기">기타</option>
          </select></br>
  
        </fieldset>
      </div>

      <div class="requester_container">
        <fieldset>
          <legend>고소인 정보 입력</legend>
    
            고소인 성명: <input type="text" id="고소인" name="고소인" onKeyDown="next_input('고소인 주소');" required> </br></br>
    
            고소인 주민등록번호:
            </br>
            <input type="text"
                  id="고소인 주민번호_앞"
                  maxlength="6"
                  placeholder="앞 6자리"
                  inputmode="numeric"
                  autocomplete="off"
                  style="width:48%; display:inline-block;"
                  >

            -
            <input type="password"
                  id="고소인 주민번호_뒤"
                  maxlength="7"
                  placeholder="뒤 7자리"
                  inputmode="numeric"
                  autocomplete="off"
                  style="width:48%; display:inline-block;"
                  >

            <input type="hidden"
                  name="고소인 주민등록번호"
                  id="고소인 주민등록번호">

            </br></br>
    
            고소인 주소:
            <input type="text"
                  id="고소인 주소"
                  name="고소인 주소"
                  placeholder="주소 검색 버튼을 눌러주세요"
                  readonly
                  required>

            <button type="button" onclick="execDaumPostcodeTarget('고소인 주소')">
              주소 검색
            </button>
            <br><br>

            고소인 직업: <input type="text" id="고소인 직업" name="고소인 직업" onKeyDown="next_input('고소인 전화');" required> </br></br>
    
            고소인 전화:
            <input type="text"
                  id="고소인 전화"
                  name="고소인 전화"
                  placeholder="숫자만 입력하세요 (예: 01012345678)"
                  oninput="formatPhoneNumber(this)"
                  onKeyDown="next_input('고소인 이메일');"
                  inputmode="numeric"
                  required>

            <small style="color:#666;">
              ※ 하이픈(-)은 자동으로 입력됩니다.
            </small>
            <br><br>
    
            고소인 이메일:
            <input type="text"
                  id="고소인 이메일"
                  name="고소인 이메일"
                  autocomplete="off"
                  oninput="emailAutoComplete(this)"
                  list="email-domain-list"
                  required>

        </fieldset>
      </div>
    

      <div class="receiver_container">
        <fieldset>
          <legend>피고소인 정보 입력</legend>
            피고소인 성명: <input type="text" id="피고소인" name="피고소인" onKeyDown="next_input('피고소인 주민등록번호');"> </br></br>
    
            피고소인 주민등록번호:
            </br>
            <input type="text"
                  id="피고소인 주민번호_앞"
                  maxlength="6"
                  placeholder="앞 6자리"
                  inputmode="numeric"
                  autocomplete="off"
                  style="width:48%; display:inline-block;"
                  >

            -
            <input type="password"
                  id="피고소인 주민번호_뒤"
                  maxlength="7"
                  placeholder="뒤 7자리"
                  inputmode="numeric"
                  autocomplete="off"
                  style="width:48%; display:inline-block;"
                  >

            <input type="hidden"
                  name="피고소인 주민등록번호"
                  id="피고소인 주민등록번호">

            </br></br>
    
            피고소인 주소:
              <input type="text"
                    id="피고소인 주소"
                    name="피고소인 주소"
                    placeholder="주소 검색 버튼을 눌러주세요"
                    readonly>

              <button type="button" onclick="execDaumPostcodeTarget('피고소인 주소')">
                주소 검색
              </button>
            <br><br>
    
            피고소인 직업: <input type="text" id="피고소인 직업" name="피고소인 직업" onKeyDown="next_input('피고소인 전화');"> </br></br>
    
            피고소인 전화:
            <input type="text"
                  id="피고소인 전화"
                  name="피고소인 전화"
                  placeholder="숫자만 입력하세요 (예: 01012345678)"
                  oninput="formatPhoneNumber(this)"
                  onKeyDown="next_input('피고소인 이메일');"
                  inputmode="numeric"
                  >

            <small style="color:#666;">
              ※ 하이픈(-)은 자동으로 입력됩니다.
            </small>
            <br><br>
    
            피고소인 이메일:
            <input type="text"
                  id="피고소인 이메일"
                  name="피고소인 이메일"
                  autocomplete="off"
                  oninput="emailAutoComplete(this)"
                  list="email-domain-list"
                  onKeyDown="next_input('피고소인과의 관계');"
                  >
        </fieldset> 
      </div>
    

    <div class="addinfo_container">
      <fieldset>
        <legend>추가 정보</legend>
        피고소인과의 관계: <input type="text" id="피고소인과의 관계" name="피고소인과의 관계" onKeyDown="next_input('기타 피고소인을 특정할 수 있는 내용');"> </br></br>
      
        기타 피고소인을 특정할 수 있는 내용: <input type="text" id="기타 피고소인을 특정할 수 있는 내용" name="기타 피고소인을 특정할 수 있는 내용" required> </br>

      </fieldset>
    </div>
  </div>

    <input type='submit' value='다음' onClick='return check_form();'>
  </form>
  

</body>

<script>
  function formatPhoneNumber(input) {
    // 숫자만 남기기
    let numbers = input.value.replace(/\D/g, "");
  
    // 길이 제한
    if (numbers.length > 11) {
      numbers = numbers.slice(0, 11);
    }
  
    let formatted = "";
  
    if (numbers.length < 4) {
      formatted = numbers;
    } else if (numbers.length < 8) {
      formatted = numbers.slice(0, 3) + "-" + numbers.slice(3);
    } else {
      formatted =
        numbers.slice(0, 3) +
        "-" +
        numbers.slice(3, 7) +
        "-" +
        numbers.slice(7);
    }
  
    input.value = formatted;
  }
</script>

<script>
  const EMAIL_DOMAINS = [
    "gmail.com",
    "naver.com",
    "daum.net",
    "hanmail.net",
    "nate.com",
    "icloud.com",
    "outlook.com",
    "kakao.com"
  ];
  
  function emailAutoComplete(input) {
    const value = input.value;
    const list = document.getElementById("email-domain-list");
  
    list.innerHTML = "";
  
    if (!value.includes("@")) return;
  
    const [id, domainPart] = value.split("@");
  
    EMAIL_DOMAINS
      .filter(domain => domain.startsWith(domainPart))
      .forEach(domain => {
        const option = document.createElement("option");
        option.value = `${id}@${domain}`;
        list.appendChild(option);
      });
  }
</script>
  
<script>
  function execDaumPostcodeTarget(targetId) {
    new daum.Postcode({
      oncomplete: function(data) {
        let addr = "";
  
        if (data.userSelectedType === "R") {
          addr = data.roadAddress;
        } else {
          addr = data.jibunAddress;
        }
  
        document.getElementById(targetId).value = addr;
      }
    }).open();
  }
</script>

<script>
  const FORM_KEY = "basic_info";

  function saveForm() {
    const data = {};
    document.querySelectorAll("input, textarea, select").forEach(el => {
      if (el.name) {
        data[el.name] = el.value;
      }
    });
    localStorage.setItem(FORM_KEY, JSON.stringify(data));
  }

  function loadForm() {
    const saved = localStorage.getItem(FORM_KEY);
    if (!saved) return;
    const data = JSON.parse(saved);
    document.querySelectorAll("input, textarea, select").forEach(el => {
      if (el.name && data[el.name] !== undefined) {
        el.value = data[el.name];
      }
    });
  }

  window.addEventListener("load", loadForm);
  document.addEventListener("input", saveForm);

  function combineRRN(frontId, backId, hiddenId) {
    const front = document.getElementById(frontId).value;
    const back = document.getElementById(backId).value;
    if (front || back) {
      document.getElementById(hiddenId).value = front + "-" + back;
    }
  }

  document.sue_info.onsubmit = function() {
    combineRRN("고소인 주민번호_앞", "고소인 주민번호_뒤", "고소인 주민등록번호");
    combineRRN("피고소인 주민번호_앞", "피고소인 주민번호_뒤", "피고소인 주민등록번호");

    if (is_submit === false) {
      const nextEl = document.getElementById(_NEXT_FOCUS) || document.getElementsByName(_NEXT_FOCUS)[0];
      if (nextEl) nextEl.focus();
      is_submit = true;
      return false;
    }
    
    return true;
  };

  function next_input(next_focus) {
    if (event.keyCode == 13) {
      is_submit = false;
      _NEXT_FOCUS = next_focus;
    }
  }
</script>


</html> 