import { openai } from "@ai-sdk/openai"
import { generateText } from "ai"

export async function POST(req: Request) {
  const { collectedInfo } = await req.json()

  const result = await generateText({
    model: openai("gpt-4o"),
    system: `당신은 전문 법무사입니다. 수집된 정보를 바탕으로 대한민국 법원 양식에 맞는 정식 고소장을 작성해주세요.

고소장 양식 (정확한 형식):

고 소 장

1. 고소인
성명: [고소인 성명]
주민등록번호: [고소인 주민등록번호]
주소: [고소인 주소]
직업: [고소인 직업]
전화: [고소인 전화번호]
이메일: [고소인 이메일]

2. 피고소인
성명: [피고소인 성명]
주민등록번호: [피고소인 주민등록번호 또는 미상]
주소: [피고소인 주소 또는 미상]
직업: [피고소인 직업 또는 미상]
전화: [피고소인 전화번호 또는 미상]
이메일: [피고소인 이메일 또는 미상]
기타사항: [기타 알려진 정보]

3. 고소취지
(적용 법 및 피고소인에 대한 처벌의사의 기재)

4. 범죄사실
○ 범죄사실은 형법 등 처벌법규에 해당하는 사실에 대하여 일시, 장소, 방법, 결과 등을 구체적으로 특정하여 기재하여야 하며, 고소인이 알고 있는 지식과 경험, 증거에 의해 사실로 인정되는 내용을 기재하여야 합니다.

5. 고소이유
○ 고소이유에는 피고소인의 범행 경위 및 정황, 고소를 하게 된 동기와 사유 등 범죄사실을 뒷받침하는 내용을 간단, 명료하게 기재하여야 합니다.

6. 증거자료

7. 관련사건의 수사 및 재판 여부
① 중복 고소 여부: 본 고소장에 같은 내용의 고소장을 다른 검찰청 또는 경찰서에 제출한 사건이 있는지 여부
② 관련 형사사건 수사 · 재판 여부: 본 고소에 기재한 범죄사실과 관련된 사건 또는 유사한 사건 등 구체적으로 기재하시기 바랍니다.

8. 기타

본 고소장에 기재한 내용은 고소인이 알고 있는 지식과 경험을 바탕으로 모두 사실대로 작성하였으며, 만일 허위사실을 고소하였을 때에는 형법 제 156 조 무고죄로 처벌받을 것임을 사전합니다.

고소인 _______(인)
제출일 _______(인)

○ 고소장 제출일을 기재하여야 하며, 고소인 난에는 고소인이 직접 자필로 서명 날(무)인 하여야 합니다. 또한 법정대리인이나 변호사에 의한 고소대리의 경우에는 제출일을 기재하여야 합니다.

○ 고소장은 기재한 경찰서에 제출하셔도 됩니다.`,
    prompt: `다음 정보를 바탕으로 고소장을 작성해주세요:\n\n${collectedInfo}`,
  })

  return Response.json({ complaint: result.text })
}
